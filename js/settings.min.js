window.Settings=(function(f){var e="settings",b=".",d={layout:f("#settings"),btnOpen:f("#btn-settings"),btnClose:f("#btn-settings-back"),fields:{logout:f("#settings-logout"),email:f("#settings-logout").find(".profile-email"),clearCache:f("#settings-clear-cache"),syncInterval:f("#settings-sync-interval"),syncOnStart:f("#settings-sync-on-start"),reloadTasksOnListOpen:f("#settings-reload-tasks-on-list-open"),vibrateOnLongPress:f("#settings-vibrate-on-long-press"),sidebarAnimation:f("#settings-sidebar-animation")}},g={bool:"bool",integer:"integer",string:"string"},c={container:"container",input:"input",select:"select",checkbox:"checkbox"},o={email:{el:d.fields.email,type:g.string,elType:c.container,"default":""},syncInterval:{el:d.fields.syncInterval,type:g.integer,elType:c.select,"default":0},syncOnStart:{el:d.fields.syncOnStart,type:g.bool,elType:c.checkbox,"default":false},reloadTasksOnListOpen:{el:d.fields.reloadTasksOnListOpen,type:g.bool,elType:c.checkbox,"default":false},vibrateOnLongPress:{el:d.fields.vibrateOnLongPress,type:g.bool,elType:c.checkbox,"default":true},sidebarAnimation:{el:d.fields.sidebarAnimation,type:g.bool,elType:c.checkbox,"default":true}};(function(){var s={layout:f("#donate"),btnOpen:f("#settings-donate"),btnClose:f("#btn-donate-back")};function r(){s.btnOpen.on("click",q);s.btnClose.on("click",p)}function q(t){t.preventDefault();App.showInDevelopmentTooltip()}function p(t){t.preventDefault();s.layout.removeClass().addClass("fade-out")}r()}());(function(){var s={layout:f("#about"),btnOpen:f("#settings-about"),btnClose:f("#btn-about-back")};function r(){s.btnOpen.on("click",q);s.btnClose.on("click",p)}function q(t){t.preventDefault();s.layout.removeClass().addClass("fade-in")}function p(t){t.preventDefault();s.layout.removeClass().addClass("fade-out")}r()}());function m(){d.btnOpen.on("click",h);d.btnClose.on("click",j);d.fields.logout.on("click",k);d.fields.clearCache.on("click",a)}function i(){var q;for(var p in o){if(o.hasOwnProperty(p)){q=Settings.get(p);if(q===null||typeof q==="undefined"){Settings.set(p,o[p]["default"])}}}}function l(){var q;for(var p in o){if(o.hasOwnProperty(p)){q=Settings.get(p);switch(o[p].elType){case c.container:o[p].el.html(q);break;case c.checkbox:o[p].el.prop("checked",!!(q));break;case c.input:o[p].el.val(q);break;case c.select:o[p].el.find('option[value="'+q+'"]').prop("selected",true);break}}}}function n(){var q;for(var p in o){if(o.hasOwnProperty(p)){switch(o[p].elType){case c.container:q=o[p].el.html();break;case c.checkbox:q=o[p].el.prop("checked");break;case c.input:q=o[p].el.val();break;case c.select:q=o[p].el.find("option:selected").val();break}Settings.set(p,q)}}Logger.info("All options saved");EV.fire("options-saved")}function h(){l();d.layout.removeClass().addClass("fade-in")}function j(p){if(typeof p==="undefined"){p=true}p&&n();d.layout.removeClass().addClass("fade-out")}function k(p){p.preventDefault();var q={h1:"Log Out",p:"Revoke access given to a Fire Tasks?",cancel:"Cancel",ok:"Log Out",action:function(){Auth.revokeToken()}};App.confirm(q)}function a(q){q.preventDefault();function p(){utils.status.show("No new version available")}window.applicationCache.addEventListener("noupdate",p);var r={h1:"Force update",p:"Clear cache and try to download latest version?",cancel:"Cancel",ok:"Confirm",action:function(){try{window.applicationCache.update();setTimeout(function(){window.applicationCache.removeEventListener("noupdate",p)},1000)}catch(s){utils.status.show("An error occurred")}}};App.confirm(r)}return{init:function(){m();i();l()},get:function(p){var q=localStorage.getItem(e+b+p);if(q===null||typeof q==="undefined"){return null}switch(o[p].type){case g.integer:return parseInt(q);case g["float"]:return parseFloat(q);case g.bool:return(q==="true");case g.string:return q}},set:function(p,q){localStorage.setItem(e+b+p,q)},remove:function(p){localStorage.removeItem(e+b+p)},hideLayout:function(p){j(p)}}}(jQuery));